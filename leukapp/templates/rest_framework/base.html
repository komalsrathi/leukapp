{% extends "sbadmin2/base.html" %}
{% load staticfiles i18n %}
{% load rest_framework %}

{% block content %}

<h2>leukapp API</h2>

<br>

<!-- Index -->
{% block breadcrumbs %}
  <ul class="breadcrumb">
    {% for breadcrumb_name, breadcrumb_url in breadcrumblist %}
      {% if forloop.last %}
        <li class="active"><a href="{{ breadcrumb_url }}">{{ breadcrumb_name }}</a></li>
      {% else %}
        <li><a href="{{ breadcrumb_url }}">{{ breadcrumb_name }}</a></li>
      {% endif %}
    {% endfor %}
  </ul>
{% endblock %}

<!-- Buttons -->
{% if 'GET' in allowed_methods %}
  <form id="get-form">
    <fieldset>
      {% if api_settings.URL_FORMAT_OVERRIDE %}
        <div class="btn-group format-selection">
          <a class="btn btn-primary js-tooltip" href="{{ request.get_full_path }}" rel="nofollow" title="Make a GET request on the {{ name }} resource">GET</a>

          <button class="btn btn-primary dropdown-toggle js-tooltip" data-toggle="dropdown" title="Specify a format for the GET request">
            <span class="caret"></span>
          </button>
          <ul class="dropdown-menu">
            {% for format in available_formats %}
              <li>
                <a class="js-tooltip format-option" href="{% add_query_param request api_settings.URL_FORMAT_OVERRIDE format %}" rel="nofollow" title="Make a GET request on the {{ name }} resource with the format set to `{{ format }}`">{{ format }}</a>
              </li>
            {% endfor %}
          </ul>
        </div>
      {% else %}
        <a class="btn btn-primary js-tooltip" href="{{ request.get_full_path }}" rel="nofollow" title="Make a GET request on the {{ name }} resource">GET</a>
      {% endif %}
    </fieldset>
  </form>
{% endif %}

{% if options_form %}
  <form class="button-form pull-right" action="{{ request.get_full_path }}" data-method="OPTIONS">
    <button class="btn btn-primary js-tooltip" title="Make an OPTIONS request on the {{ name }} resource">OPTIONS</button>
  </form>
{% endif %}

{% if delete_form %}
  <form class="button-form" action="{{ request.get_full_path }}" data-method="DELETE">
    <button class="btn btn-danger js-tooltip" title="Make a DELETE request on the {{ name }} resource">DELETE</button>
  </form>
{% endif %}

{% if filter_form %}
    <button style="float: right; margin-right: 10px" data-toggle="modal" data-target="#filtersModal" class="btn btn-default">
        <span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
        {% trans "Filters" %}
    </button>
{% endif %}

<!-- Main content -->
<div class="page-header">
    <h3>{{ name }}</h3>
</div>
<div style="float:left">
  {% block description %}
    {{ description }}
  {% endblock %}
</div>

{% if paginator %}
  <nav style="float: right">
    {% get_pagination_html paginator %}
  </nav>
{% endif %}

<div class="request-info" style="clear: both" >
  <pre class="prettyprint"><b>{{ request.method }}</b> {{ request.get_full_path }}</pre>
</div>

<!-- Forms -->
{% if display_edit_forms %}

  {% if post_form or raw_data_post_form %}
    <div {% if post_form %}class="tabbable"{% endif %}>
      {% if post_form %}
        <ul class="nav nav-tabs form-switcher">
          <li>
            <a name='html-tab' href="#post-object-form" data-toggle="tab">HTML form</a>
          </li>
          <li>
            <a name='raw-tab' href="#post-generic-content-form" data-toggle="tab">Raw data</a>
          </li>
        </ul>
      {% endif %}

      <div class="well tab-content">
        {% if post_form %}
          <div class="tab-pane" id="post-object-form">
            {% with form=post_form %}
              <form action="{{ request.get_full_path }}" method="POST" enctype="multipart/form-data" class="form-horizontal" novalidate>
                <fieldset>
                  {% csrf_token %}
                  {{ post_form }}
                  <div class="form-actions">
                    <button class="btn btn-primary" title="Make a POST request on the {{ name }} resource">POST</button>
                  </div>
                </fieldset>
              </form>
            {% endwith %}
          </div>
        {% endif %}

        <div {% if post_form %}class="tab-pane"{% endif %} id="post-generic-content-form">
          {% with form=raw_data_post_form %}
            <form action="{{ request.get_full_path }}" method="POST" class="form-horizontal">
              <fieldset>
                {% include "rest_framework/raw_data_form.html" %}
                <div class="form-actions">
                  <button class="btn btn-primary" title="Make a POST request on the {{ name }} resource">POST</button>
                </div>
              </fieldset>
            </form>
          {% endwith %}
        </div>
      </div>
    </div>
  {% endif %}

  {% if put_form or raw_data_put_form or raw_data_patch_form %}
    <div {% if put_form %}class="tabbable"{% endif %}>
      {% if put_form %}
        <ul class="nav nav-tabs form-switcher">
          <li>
            <a name='html-tab' href="#put-object-form" data-toggle="tab">HTML form</a>
          </li>
          <li>
            <a  name='raw-tab' href="#put-generic-content-form" data-toggle="tab">Raw data</a>
          </li>
        </ul>
      {% endif %}

      <div class="well tab-content">
        {% if put_form %}
          <div class="tab-pane" id="put-object-form">
            <form action="{{ request.get_full_path }}" data-method="PUT" enctype="multipart/form-data" class="form-horizontal" novalidate>
              <fieldset>
                {{ put_form }}
                <div class="form-actions">
                  <button class="btn btn-primary js-tooltip" title="Make a PUT request on the {{ name }} resource">PUT</button>
                </div>
              </fieldset>
            </form>
          </div>
        {% endif %}

        <div {% if put_form %}class="tab-pane"{% endif %} id="put-generic-content-form">
          {% with form=raw_data_put_or_patch_form %}
            <form action="{{ request.get_full_path }}" data-method="PUT" class="form-horizontal">
              <fieldset>
                {% include "rest_framework/raw_data_form.html" %}
                <div class="form-actions">
                  {% if raw_data_put_form %}
                    <button class="btn btn-primary js-tooltip" title="Make a PUT request on the {{ name }} resource">PUT</button>
                  {% endif %}
                  {% if raw_data_patch_form %}
                  <button data-method="PATCH" class="btn btn-primary js-tooltip" title="Make a PATCH request on the {{ name }} resource">PATCH</button>
                    {% endif %}
                </div>
              </fieldset>
            </form>
          {% endwith %}
        </div>

        <div class="tab-pane" id="put-http-response">

        </div>

      </div>
    </div>
  {% endif %}
{% endif %}

{% if filter_form %}
{{ filter_form }}
{% endif %}

<!-- Response -->
<div class="response-info">
  <pre class="prettyprint"><span class="meta nocode"><b>HTTP {{ response.status_code }} {{ response.status_text }}</b>{% autoescape off %}
{% for key, val in response_headers.items %}<b>{{ key }}:</b> <span class="lit">{{ val|break_long_headers|urlize_quoted_links }}</span>
{% endfor %}
</span>{{ content|urlize_quoted_links }}</pre>{% endautoescape %}
</div>

{% endblock content %}

{% block extra_javascript %}
  <script src="{% static "rest_framework/js/ajax-form.js" %}"></script>
  <script src="{% static "rest_framework/js/csrf.js" %}"></script>
  <script src="{% static "rest_framework/js/prettify-min.js" %}"></script>
  <script src="{% static "rest_framework/js/default.js" %}"></script>
  <script>
      $(document).ready(function() {
          $('form').ajaxForm();
      });
  </script>
{% endblock extra_javascript %}
